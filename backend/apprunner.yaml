version: 1.0
runtime: php82
build:
  commands:
    pre-build:
      - apt-get update -qq
      - apt-get install -y -qq git zip unzip
    build:
      - composer install --no-dev --optimize-autoloader --no-interaction
      - php artisan config:cache
      - php artisan route:cache
      - php artisan view:cache
    post-build:
      - chmod -R 755 storage bootstrap/cache
      - php artisan storage:link || true

run:
  command: php artisan serve --host=0.0.0.0 --port=8080
  network:
    port: 8080
  env:
    - name: APP_ENV
      value: "production"
    - name: LOG_CHANNEL
      value: "stderr"
    - name: APP_DEBUG
      value: "false"
